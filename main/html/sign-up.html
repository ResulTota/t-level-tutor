<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Sign Up - TLevelTutor</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="/javascript/main.js" type="module" defer></script>

<body>
  <header>
      <a href="index.html">
        <img src="../images/logo.png" alt="TLevelTutor Logo" width="100" height="100" id="header-logo"/>
      </a>
        <button id = "theme-switch">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Z"/></svg>
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M480-280q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Z"/></svg>
        </button>
  </header>

    <div class="signup-box">
        <h2>Create Account</h2>
        <form id="signupForm" action="/signup_action.php" method="post">

        <div class = "form-left">
          <label for="uname">Sign Up</label>

          <label for="email"></label>
          <input type="email" placeholder="Email" name="email" required>

          <label for="psw"></label>
          <input type="password" placeholder="Enter Password" name="psw" id="psw" required>

          <label for="psw-repeat"></label>
          <input type="password" placeholder="Confirm Password" name="psw-repeat" id="psw-repeat" required>

          <p id="error-message" style="color:red; display:none;">Passwords do not match!</p>
          
          <button type="submit" class="signupbtn">Sign Up</button>
          <button type="button" class="cancelbtn" onclick="window.location.href='index.html'">Cancel</button>
        </div>

          <div class="right-align">
            <div class="tubby1">
              <img src="../images/tubby1.png" alt="tubby1" width="350" height="350"/>
            </div>

            <button id="googleSignUp">
              <span>Sign Up with Google </span>
              <img id="google-icon" src="../images/google-icon.png"/>
            </button>

            <p class="login-link">Already have an account? <a href="log-in.html">Login</a></p>
          </div>

        </form>
    </div>

  </body>

    <script>
        document.getElementById("signupForm").addEventListener("submit", function(event) {
        let password = document.getElementById("psw").value;
        let confirmPassword = document.getElementById("psw-repeat").value;
        let errorMessage = document.getElementById("error-message");

        if (password !== confirmPassword) {
            event.preventDefault(); // stop form from submitting
            errorMessage.style.display = "block"; // show error
        } else {
            errorMessage.style.display = "none"; // hide error if fixed
        }
        });
          
          let darkmode = localStorage.getItem('darkmode')
          const themeSwitch = document.getElementById('theme-switch')

          const enableDarkmode = () => {
            document.body.classList.add('darkmode')
            localStorage.setItem('darkmode', 'active')
          }

          const disableDarkmode = () => {
            document.body.classList.remove('darkmode')
            localStorage.setItem('darkmode', null)
          }

          if(darkmode === "active") enableDarkmode()

          themeSwitch.addEventListener("click", () => {
            darkmode = localStorage.getItem('darkmode')
            darkmode !== "active" ? enableDarkmode() : disableDarkmode()
          })
    </script>

<!-- Firebase Script -->
<script type="module">
  // Import Firebase SDKs from CDN
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-analytics.js";
  import { getAuth, signInWithPopup, GoogleAuthProvider, signOut } 
    from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC_eZWC9B2nWY-5_0UDswLRlL7Ssa1pSt0",
      authDomain: "tleveltutor.firebaseapp.com",
      projectId: "tleveltutor",
      storageBucket: "tleveltutor.firebasestorage.app",
      messagingSenderId: "978451529313",
      appId: "1:978451529313:web:33ffc6efd85ad713d8f420",
      measurementId: "G-T47VXPDZEJ"
    };

      // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);

  // Setup Auth
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // Sign in with Google
  document.getElementById("googleSignUp").addEventListener("click", async () => {
    try {
      const result = await signInWithPopup(auth, provider);
      const user = result.user;
      document.getElementById("userInfo").innerText = `Hello, ${user.displayName}`;
      console.log("Signed in:", user);
    } catch (error) {
      console.error("Sign in error:", error);
    }
  });

  // Sign out
  document.getElementById("signOut").addEventListener("click", async () => {
    await signOut(auth);
    document.getElementById("userInfo").innerText = "Signed out";
  });
</script>

</body>
</html>
