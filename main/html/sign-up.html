<!DOCTYPE html>
<html lang="en">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Sign Up - TLevelTutor</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="/javascript/main.js" type="module" defer></script>

<body>

    <div class="signup-box">
        <h2>Create Account</h2>
        <form id="signupForm" action="/signup_action.php" method="post">
        <label for="uname"><b>Username</b></label>
        <input type="text" placeholder="Choose a Username" name="uname" required>

        <label for="email"><b>Email</b></label>
        <input type="email" placeholder="Enter Email" name="email" required>

        <label for="psw"><b>Password</b></label>
        <input type="password" placeholder="Enter Password" name="psw" id="psw" required>

        <label for="psw-repeat"><b>Repeat Password</b></label>
        <input type="password" placeholder="Repeat Password" name="psw-repeat" id="psw-repeat" required>

        <p id="error-message" style="color:red; display:none;">Passwords do not match!</p>

        
        
        <button type="submit">Sign Up</button>
        <button type="button" class="cancelbtn" onclick="window.location.href='index.html'">Cancel</button>
        </form>

        <button id="googleSignUp">
            <span>Sign Up with Google </span>
            <img id= "google-icon" src="../images/google-icon.png"/>
        </button>

        <p class="login-link">Already have an account? <a href="log-in.html">Login</a></p>
    </div>

    <script>
        document.getElementById("signupForm").addEventListener("submit", function(event) {
        let password = document.getElementById("psw").value;
        let confirmPassword = document.getElementById("psw-repeat").value;
        let errorMessage = document.getElementById("error-message");

        if (password !== confirmPassword) {
            event.preventDefault(); // stop form from submitting
            errorMessage.style.display = "block"; // show error
        } else {
            errorMessage.style.display = "none"; // hide error if fixed
        }
        });
    </script>

<!-- Firebase Script -->
<script type="module">
  // Import Firebase SDKs from CDN
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-analytics.js";
  import { getAuth, signInWithPopup, GoogleAuthProvider, signOut } 
    from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyC_eZWC9B2nWY-5_0UDswLRlL7Ssa1pSt0",
      authDomain: "tleveltutor.firebaseapp.com",
      projectId: "tleveltutor",
      storageBucket: "tleveltutor.firebasestorage.app",
      messagingSenderId: "978451529313",
      appId: "1:978451529313:web:33ffc6efd85ad713d8f420",
      measurementId: "G-T47VXPDZEJ"
    };

      // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);

  // Setup Auth
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // Sign in with Google
  document.getElementById("googleSignUp").addEventListener("click", async () => {
    try {
      const result = await signInWithPopup(auth, provider);
      const user = result.user;
      document.getElementById("userInfo").innerText = `Hello, ${user.displayName}`;
      console.log("Signed in:", user);
    } catch (error) {
      console.error("Sign in error:", error);
    }
  });

  // Sign out
  document.getElementById("signOut").addEventListener("click", async () => {
    await signOut(auth);
    document.getElementById("userInfo").innerText = "Signed out";
  });
</script>

</body>
</html>
